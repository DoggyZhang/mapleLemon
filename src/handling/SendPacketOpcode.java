package handling;

import constants.ServerConstants;
import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Properties;
import server.ServerProperties;
import tools.EncodingDetect;
import tools.FileoutputUtil;

public enum SendPacketOpcode implements WritableIntValueHolder {


    LOGIN_STATUS(0x01),
    CHOOSE_GENDER(0x02),
    GENDER_SET(0x03),
    SERVERSTATUS(0x04),
    SERVERLIST(0x05),
    CHARLIST(0x06),
    SERVER_IP(0x07),
    CHAR_NAME_RESPONSE(0x08),
    REGISTER_INFO(0x09),
    CHECK_ACCOUNT_INFO(0x0A),
    REGISTER_ACCOUNT(0x0B),
    ADD_NEW_CHAR_ENTRY(0x0C),
    DELETE_CHAR_RESPONSE(0x0D),
    CHANGE_CHANNEL(0x0E),
    PING(0x0F),
    MODIFY_INVENTORY_ITEM(0x17),
    UPDATE_INVENTORY_SLOT(0x18),
    UPDATE_STATS(0x19),
    GIVE_BUFF(0x1A),
    CANCEL_BUFF(0x1B),
    UPDATE_SKILLS(0x1D),
    FAME_RESPONSE(0x1F),
    SHOW_STATUS_INFO(0x20),
    SHOW_NOTES(0x21),
    TROCK_LOCATIONS(0x22),
    CHAR_INFO(0x24),
    PARTY_OPERATION(0x25),
    BUDDYLIST(0x26),
    SPAWN_PORTAL(0x27),
    SERVERMESSAGE(0x28),
    WARP_TO_MAP(0x2B),
    CS_CHAR(0x2C),
    MULTICHAT(0x32),
    WHISPER(0x33),
    MAP_EFFECT(0x35),
    FULLSCREEN_BLESS(0x36),
    CASH_SONG(0x37),
    GM_EFFECT(0x38),
    OX_QUIZ(0x39),
    CLOCK(0x3B),
    BOAT_EFFECT(0x3C),
    BOAT_STATE(0x3D),
    SPAWN_PLAYER(0x40),
    REMOVE_PLAYER_FROM_MAP(0x41),
    CHATTEXT(0x43),
    SPAWN_PET(0x47),
    MOVE_PET(0x48),
    PET_CHAT(0x49),
    PET_NAMECHANGE(0x4A),
    PET_COMMAND(0x4B),
    MOVE_PLAYER(0x56),
    CLOSE_RANGE_ATTACK(0x57),
    RANGED_ATTACK(0x58),
    MAGIC_ATTACK(0x59),
    SKILL_EFFECT(0x5A),
    CANCEL_SKILL_EFFECT(0x5B),
    DAMAGE_PLAYER(0x5C),
    FACIAL_EXPRESSION(0x5D),
    UPDATE_CHAR_LOOK(0x5E),
    SHOW_FOREIGN_EFFECT(0x5F),
    GIVE_FOREIGN_BUFF(0x60),
    CANCEL_FOREIGN_BUFF(0x61),
    UPDATE_PARTYMEMBER_HP(0x62),
    SHOW_CHAIR(0x65),
    SHOW_SPECIAL_EFFECT(0x66),
    MESOBAG_SUCCESS(0x6A),
    MESOBAG_FAILURE(0x6B),
    SPAWN_SUMMON(0x4E),
    REMOVE_SUMMON(0x4F),
    MOVE_SUMMON(0x50),
    SUMMON_ATTACK(0x51),
    DAMAGE_SUMMON(0x52),
    SPAWN_MONSTER(0x6F),
    KILL_MONSTER(0x70),
    SPAWN_MONSTER_CONTROL(0x71),
    MOVE_MONSTER(0x73),
    MOVE_MONSTER_RESPONSE(0x74),
    DAMAGE_MONSTER(0x7A),
    APPLY_MONSTER_STATUS(0x76),
    CANCEL_MONSTER_STATUS(0x77),
    SPAWN_NPC(0x80),
    REMOVE_NPC(0x81),
    SPAWN_NPC_REQUEST_CONTROLLER(0x82),
    NPC_ACTION(0x84),
    SKILL_EFFECT_MOB(0x7B),
    DROP_ITEM_FROM_MAPOBJECT(0x88),
    REMOVE_ITEM_FROM_MAP(0x89),
    MESSAGEBOX_ERROR(0x8C),
    SPAWN_LOVE(0x8D),
    REMOVE_LOVE(0x8E),
    SPAWN_DEFENDER(0x91),
    REMOVE_DEFENDER(0x92),
    SPAWN_DOOR(0x95),
    REMOVE_DOOR(0x96),
    REACTOR_HIT(0x99),
    REACTOR_SPAWN(0x9B),
    REACTOR_DESTROY(0x9C),
    NPC_TALK(0xA5),
    OPEN_NPC_SHOP(0xA8),
    CONFIRM_SHOP_TRANSACTION(0xA9),
    STORAGE_OPEN(0xAD),
    STORAGE_OPERATION(0xAE),
    CS_UPDATE(0xC0),
    CS_OPERATION(0xC1);

//
//    CS_USE,
//    EVENT_CHECK,
//    WORK_RESPONSE,
//    LICENSE_RESULT,
//    AUTO_LOGIN_STATUS,
//    UNK0008,
//    SHOW_CHAR_CARDS,
//    SHOW_ACC_CASH,
//    WZ_CHECK,
//    CHANNEL_SELECTED,
//    RSA_KEY,
//    ENABLE_RECOMMENDED,
//    SEND_RECOMMENDED,
//    LOGIN_AUTH,
//    EJECT_WEB,
//    SECONDPW_ERROR,
//    LOGIN_SECOND,
//    PIN_OPERATION,
//    ALL_CHARLIST,
//    TEMP_STATS,
//    TEMP_STATS_RESET,
//    UPDATE_SKILL_TICK,
//    SKILL_MEMORY,
//    LIE_DETECTOR,
//    REPORT_RESPONSE,
//    ENABLE_REPORT,
//    UPDATE_MOUNT,
//    SHOW_QUEST_COMPLETION,
//    SEND_TITLE_BOX,
//    USE_SKILL_BOOK,
//    SP_RESET,
//    AP_RESET,
//    POTION_POT_MSG,
//    POTION_POT_UPDATE,
//    FINISH_SORT,
//    FINISH_GATHER,
//    REPORT_RESULT,
//    TRADE_LIMIT,
//    UPDATE_GENDER,
//    MEMBER_SEARCH,
//    PARTY_SEARCH,
//    BOOK_INFO,
//    GUILD_OPERATION,
//    GUILD_SEARCH,
//    ALLIANCE_OPERATION,
//    MECH_PORTAL,
//    PIGMI_REWARD,
//    OPEN_MAP,
//    OWL_OF_MINERVA,
//    OWL_RESULT,
//    ENGAGE_REQUEST,
//    ENGAGE_RESULT,
//    YELLOW_CHAT,
//    SHOP_DISCOUNT,
//    CATCH_MOB,
//    PET_PICKUP_MSG,
//    PET_AUTO_EAT_MSG,
//    SYNTHESIZING_MSG,
//    FISHING_BOARD_UPDATE,
//    BBS_OPERATION,
//    NPC_HIDE,
//    PLAYER_NPC,
//    ENERGY,
//    GHOST_POINT,
//    GHOST_STATUS,
//    FAIRY_PEND_MSG,
//    SEND_PEDIGREE,
//    OPEN_FAMILY,
//    FAMILY_MESSAGE,
//    FAMILY_INVITE,
//    FAMILY_JUNIOR,
//    SENIOR_MESSAGE,
//    FAMILY,
//    REP_INCREASE,
//    FAMILY_LOGGEDIN,
//    FAMILY_BUFF,
//    FAMILY_USE_REQUEST,
//    LEVEL_UPDATE,
//    MARRIAGE_UPDATE,
//    JOB_UPDATE,
//    PENDANT_SLOT,
//    FOLLOW_REQUEST,
//    TOP_MSG,
//    MID_MSG,
//    CLEAR_MID_MSG,
//    MAPLE_ADMIN,
//    GM_POLICE,
//    UPDATE_JAGUAR,
//    ULTIMATE_EXPLORER,
//    PAM_SONG,
//    PROFESSION_INFO,
//    UPDATE_IMP_TIME,
//    ITEM_POT,
//    UNK0092,
//    GIVE_CHARACTER_SKILL,
//    MULUNG_DOJO_RANKING,
//    EQUIPPED_SKILL,
//    TV_MESSAGE,
//    UPDATE_INNER_SKILL,
//    UPDATE_INNER_STATS,
//    CONFIRM_CROSS_HUNTER,
//    LOVE_OPERATION,
//    CANCEL_TITLE_EFFECT,
//    UPDATE_CORE_AURA,
//    OPEN_WEB,
//    CHAR_CASH,
//    UNK00A6,
//    SHOW_PREDICT_CARD,
//    SYSTEM_PROCESS_LIST,
//    AVATAR_MEGA_RESULT,
//    AVATAR_MEGA,
//    AVATAR_MEGA_REMOVE,
//    FISHING_STORE,
//    SHOW_PLAYER_CASH,
//    PLAYER_CASH_UPDATE,
//    MTS_OPEN,
//    CS_OPEN,
//    LOGIN_WELCOME,
//    RESET_SCREEN,
//    MAP_BLOCKED,
//    SERVER_BLOCKED,
//    PARTY_BLOCKED,
//    SHOW_EQUIP_EFFECT,
//    BOSS_ENV,
//    MOVE_ENV,
//    UPDATE_ENV,
//    UNK00BC,
//    UNK00BF,
//    GMEVENT_INSTRUCTIONS,
//    BOAT_EFF,
//    LOGIN_SUCC,
//    STOP_CLOCK,
//    PYRAMID_UPDATE,
//    PYRAMID_RESULT,
//    QUICK_SLOT,
//    MOVE_PLATFORM,
//    PVP_INFO,
//    DIRECTION_STATUS,
//    GAIN_FORCE,
//    QUICK_MOVE,
//    CHALKBOARD,
//    UPDATE_CHAR_BOX,
//    SHOW_CONSUME_EFFECT,
//    SHOW_SCROLL_EFFECT,
//    SHOW_MAGNIFYING_EFFECT,
//    SHOW_POTENTIAL_RESET,
//    SHOW_ADDITIONAL_EFFECT,
//    SHOW_ADDITIONAL_RESET,
//    SHOW_FIREWORKS_EFFECT,
//    SHOW_FUSION_EFFECT,
//    PLAYER_DAMAGED,
//    PVP_ATTACK,
//    PVP_MIST,
//    PVP_COOL,
//    TESLA_TRIANGLE,
//    FISHING_CAUGHT,
//    PAMS_SONG,
//    FOLLOW_EFFECT,
//    CRAFT_EFFECT,
//    CRAFT_COMPLETE,
//    HARVESTED,
//    PET_EXCEPTION_LIST,
//    SHOW_PET,
//    DRAGON_SPAWN,
//    DRAGON_MOVE,
//    DRAGON_REMOVE,
//    ANDROID_SPAWN,
//    ANDROID_MOVE,
//    ANDROID_EMOTION,
//    ANDROID_UPDATE,
//    ANDROID_DEACTIVATED,
//    PASSIVE_ATTACK,
//    SHOW_ITEM_EFFECT,
//    SHOW_TITLE_EFFECT,
//    SHOW_UNK_EFFECT,
//    LOAD_GUILD_NAME,
//    LOAD_GUILD_ICON,
//    LOAD_TEAM,
//    SHOW_HARVEST,
//    PVP_HP,
//    SHOW_DRAGON_FLY,
//    UPDATE_ZERO_LOOK,
//    REMOVE_ZERO_FROM_MAP,
//    SHOW_SPECIAL_ATTACK,
//    CANCEL_CHAIR,
//    CURRENT_MAP_WARP,
//    UPDATE_QUEST_INFO,
//    BUFF_BAR,
//    PET_FLAG_CHANGE,
//    PLAYER_HINT,
//    EVENT_WINDOW,
//    OPEN_UI_OPTION,
//    INTRO_LOCK,
//    INTRO_ENABLE_UI,
//    INTRO_DISABLE_UI,
//    SUMMON_HINT,
//    SUMMON_HINT_MSG,
//    ARAN_COMBO,
//    ARAN_COMBO_RECHARGE,
//    GAME_POLL_REPLY,
//    CRAFT_MESSAGE,
//    SPOUSE_MESSAGE,
//    FOLLOW_MOVE,
//    FOLLOW_MSG,
//    GAME_POLL_QUESTION,
//    CREATE_ULTIMATE,
//    HARVEST_MESSAGE,
//    SHOW_MAP_NAME,
//    OPEN_BAG,
//    DRAGON_BLINK,
//    PVP_ICEGAGE,
//    DIRECTION_INFO,
//    REISSUE_MEDAL,
//    PLAY_MOVIE,
//    SHOW_CARTE,
//    LUMINOUS_COMBO,
//    UNKNOWN_1FC,
//    COOLDOWN,
//    PVP_SUMMON,
//    SUMMON_SKILL,
//    UNK0185,
//    SHOW_MONSTER_HP,
//    SHOW_MAGNET,
//    CATCH_MONSTER,
//    MONSTER_PROPERTIES,
//    REMOVE_TALK_MONSTER,
//    TALK_MONSTER,
//    NPC_SET_SPECIAL_ACTION,
//    NPC_SCRIPTABLE,
//    UNK01A2,
//    SPAWN_HIRED_MERCHANT,
//    DESTROY_HIRED_MERCHANT,
//    UPDATE_HIRED_MERCHANT,
//    CHANGE_HIRED_MERCHANT_NAME,
//    MECH_DOOR_SPAWN,
//    MECH_DOOR_REMOVE,
//    SPAWN_EXTRACTOR,
//    REMOVE_EXTRACTOR,
//    ROLL_SNOWBALL,
//    HIT_SNOWBALL,
//    SNOWBALL_MESSAGE,
//    LEFT_KNOCK_BACK,
//    HIT_COCONUT,
//    COCONUT_SCORE,
//    MONSTER_CARNIVAL_START,
//    MONSTER_CARNIVAL_OBTAINED_CP,
//    MONSTER_CARNIVAL_PARTY_CP,
//    MONSTER_CARNIVAL_SUMMON,
//    MONSTER_CARNIVAL_DIED,
//    CHAOS_ZAKUM_SHRINE,
//    CHAOS_HORNTAIL_SHRINE,
//    HORNTAIL_SHRINE,
//    ENGLISH_QUIZ,
//    PVP_TYPE,
//    PVP_TRANSFORM,
//    PVP_ENABLED,
//    PVP_SCORE,
//    PVP_RESULT,
//    PVP_TEAM,
//    PVP_SCOREBOARD,
//    PVP_POINTS,
//    PVP_KILLED,
//    PVP_MODE,
//    PVP_ICEKNIGHT,
//    CAPTURE_FLAGS,
//    CAPTURE_POSITION,
//    CAPTURE_RESET,
//    MERCH_ITEM_MSG,
//    MERCH_ITEM_STORE,
//    RPS_GAME,
//    MESSENGER,
//    PLAYER_INTERACTION,
//    DUEY,
//    CS_UPDATE_MESO,
//    CS_UNK1,
//    CS_HOT,
//    CS_DAILY,
//    CS_UNK2,
//    CS_GM_GIFI,
//    CS_MSG,
//    XMAS_SURPRISE,
//    KEYMAP,
//    PET_AUTO_HP,
//    PET_AUTO_MP,
//    PET_AUTO_BUFF,
//    START_TV,
//    REMOVE_TV,
//    ENABLE_TV,
//    SHOW_SCROLL_TIP,
//    GET_MTS_TOKENS,
//    MTS_OPERATION,
//    VICIOUS_HAMMER,
//    MACROSS_TICKET,
//    ERRORR_MACROSS_TICKET,
//    ALIEN_SOCKET_CREATOR,
//    ECHO_MESSAGE,
//    SHOW_MESO_GAIN,
//    ANNOUNCE_PLAYER_SHOP,
//    EARN_TITLE_MSG,
//    ARIANT_PQ_START,
//    ARIANT_SCOREBOARD,
//    GET_CARD,
//    CARD_SET,
//    BOOK_STATS,
//    R_MESOBAG_SUCCESS,
//    R_MESOBAG_FAILURE,
//    SPOUSE_CHAT,
//    CHANGE_BACKGROUND,
//    VISITOR,
//    REGISTER_FAMILIAR,
//    SPAWN_FAMILIAR,
//    MOVE_FAMILIAR,
//    ATTACK_FAMILIAR,
//    UPDATE_FAMILIAR,
//    TOUCH_FAMILIAR,
//    SIDEKICK_OPERATION,
//    RESET_MINIMAP,
//    ACHIEVEMENT_RATIO,
//    BOOSTER_FAMILIAR,
//    BOOSTER_PACK,
//    FAMILIAR_INFO,
//    MONSTER_CARNIVAL_LEAVE,
//    MONSTER_CARNIVAL_STATS,
//    MONSTER_CARNIVAL_RESULT,
//    MONSTER_CARNIVAL_RANKING,
//    MOB_TO_MOB_DAMAGE,

//    ITEM_EFFECT_MOB,
//    CYGNUS_ATTACK,
//    SPECIAL_CREATION,
//    EXIT_GAME,
//    SPAWN_RUNE,
//    MAP_SCENE,
//    ELITE_BOSS_MSG,
//    BOSS_PARTY_SEARCH_RESPONSE,
//    BOSS_PARTY_SEARCH,
//    SPAWN_ARROWS_TURRET,
//    ARROWS_TURRET_ACTION,
//    ARROWS_TURRET_ATTACK,
//    CANCEL_ARROWS_TURRET,
//    MONSTER_RESIST,
//    SHOW_VOID_PRESSURE,
//    SHOW_SUPER_SPECTRA,
//    NPC_UPDATE_LIMITED_INFO,
//    DIRECTION_FACIAL_EXPRESSION,
//    LUCKY_MONEY,
//    ADVANCED_ATTACK,
//    ANGEL_REBORN_DONE,
//    ANGEL_REBORN,
//    HS_CHECK,//HS检测
//    UPDATE_MAC_SKILL,
//    FIRE_STEP,
//    CONVEY_TO,
//    REMOVE_RUNE,
//    RUNE_OPERATION,
//    RUNE_SKILL,
//    TOP_MSG_WHITE,
//    ELAB_OPERATION,
//    OPEN_UI,

//    ;

    private byte code = -2;
    public static boolean record = false;

    SendPacketOpcode(int code) {
        this.code = (byte)code;
    }

    @Override
    public void setValue(byte code) {
        this.code = code;
    }

    @Override
    public byte getValue() {
        if (ServerProperties.ShowPacket()) {
            if (isRecordHeader(this)) {
                record = true;
                FileoutputUtil.log(FileoutputUtil.Packet_Record, "[服务端发送] " + name() + "  [0x" + code + "]  " + FileoutputUtil.CurrentReadable_Time() + "\r\n");
            } else {
                record = false;
            }
        }
        return this.code;
    }

    public short getValue(boolean show) {
        return code;
    }

    public boolean isRecordHeader(SendPacketOpcode opcode) {
        switch (opcode) {
//            case MOVE_MONSTER_RESPONSE:
//            case WARP_TO_MAP:
//            case GUILD_OPERATION:
//            case PARTY_OPERATION:
//            case GIVE_BUFF:
//            case SPAWN_PLAYER:
//                return true;
            default:
                return false;
        }
    }

    public static boolean isSpamHeader(SendPacketOpcode opcode) {
        switch (opcode) {
//            case MOVE_MONSTER_RESPONSE:
//            case SPAWN_MONSTER:
//            case SPAWN_MONSTER_CONTROL:
//            case NPC_ACTION:
//                return true;
            default:
                return false;
        }
    }
}
